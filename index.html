<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quackin' Up!</title>
    <script src="js/pixi.min.js"></script>
    <script src="https://unpkg.com/@pixi/sound/dist/pixi-sound.js"></script>
    <script>
      const WIDTH = window.innerWidth * 0.8;
      const HEIGHT = window.innerHeight * 0.8;
      let app;
      let background;
      let duck;
      let fox;
      let keys = {};

      window.onload = function () {
        // Setting container
        app = new PIXI.Application({
          width: WIDTH,
          height: HEIGHT,
          backgroundColor: 0xffffff,
        });

        document.body.appendChild(app.view);

        // music
        PIXI.sound.add("my-sound", {
          url: "music/Duck_Game_Song.mp3",
          loop: true,
        });
        PIXI.sound.play("my-sound");
        PIXI.sound.volume("my-sound", 0.1);

        // load background
        background = PIXI.Sprite.from("images/background.jpg");
        background.anchor.set(0.5);

        // fit background to screen
        background.position.set(app.screen.width / 2, app.screen.height / 2); //center of screen
        background.width = WIDTH;
        background.height = HEIGHT;
        app.stage.addChild(background);

        // Fox sprite
        fox = PIXI.Sprite.from("images/fox1.png");

        fox.anchor.set(0.5);
        fox.x = app.view.width / 1.15;
        fox.y = app.view.height - 160;

        fox.width = 250;
        fox.height = 250;
        app.stage.addChild(fox);

        // Duck sprite
        duck = PIXI.Sprite.from("images/duck.png");
        duck.anchor.set(0.5);
        duck.x = app.view.width / 2;
        duck.y = app.view.height - 100;

        app.stage.addChild(duck);

        // Movement event handlers
        window.addEventListener("keydown", keysDown);
        window.addEventListener("keyup", keysUp);

        app.ticker.add(gameLoop);

        function keysDown(e) {
          keys[e.keyCode] = true;
        }

        function keysUp(e) {
          keys[e.keyCode] = false;
        }

        function gameLoop() {
          // right
          if (keys["39"]) {
            duck.scale.x = 1;
            if (duck.x < app.view.width - 55) {
              duck.x += 5;
            }
          }
          // left
          if (keys["37"]) {
            duck.scale.x = -1;
            if (duck.x > 55) {
              duck.x -= 5;
            }
          }
          // jump
          if (keys["32"]) {
            duck.y = HEIGHT / 1.25;
          }
          if (!keys["32"]) {
            duck.y = app.view.height - 100;
          }
        }
      };
    </script>
  </head>
  <body></body>
  <style>
    html,
    body {
      height: 100%;
    }
    html {
      display: table;
      margin: auto;
      background-color: #fef9c3;
    }
    body {
      display: table-cell;
      vertical-align: middle;
    }
  </style>
</html>
